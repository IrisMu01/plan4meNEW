<!DOCTYPE html>

<head>
    <title>Plan4Me - Planning Your Trip</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        {% load static %}
        <link rel="stylesheet" type="text/css" href="{% static 'style/result.css' %}">

        <!--bootstrap, jquery and such-->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

        <!--api-->
        <script src="https://maps.googleapis.com/maps/api/js?key={{key}}&libraries=places&callback=initMap" defer></script>

        <!--initializing global variables from view.py's context vars-->
        <script>
            var city = "{{city}}";
            var date_from = new Date('{{date_from}}').toISOString().slice(0, 10);
            var date_to = new Date('{{date_to}}').toISOString().slice(0, 10);
            var strCoord = "{{coordinates}}";
            var cleanStrCoord = strCoord.replace(/&quot;/g, '"');
            var coordinates = JSON.parse(cleanStrCoord);
            // ---------------------------------------
            var hotels_raw = "{{hotels}}";
            var pois_raw = "{{pois}}";
            var max_price = "{{max_price}}";
            var booze_check = "{{booze_check}}" == "True";

            var clean_hotels_str = hotels_raw.replace(/&quot;/g, '"');
            clean_hotels_str = clean_hotels_str.replace(/&amp;/g, '&');
            var clean_pois_str = pois_raw.replace(/&#x27;/g, '').slice(1, -1);

            var hotels = JSON.parse(clean_hotels_str);
            var pois = clean_pois_str.split(', ').map(x => Number(x));
            // ----------------------------------------
            var map;
            function initMap(){
                map = new google.maps.Map(document.getElementById('map'), {
                    center: coordinates,
                    zoom: 13
                });
            }
        </script>
        
        <!--ui & dynamic contents-->
        <script src="{% static 'javascript/result-a.js' %}"></script>
        <script src="{% static 'javascript/result-b.js' %}"></script>
        <script src="{% static 'javascript/result-c.js' %}"></script>
</head>

<body>
    <header id="site-title">
        <h2 id="slogan1" class="slogan">Travel planning</h2>
        <img id="logo" src="{% static 'images/logo.png' %}">
        <h2 id="slogan2" class="slogan"> made SIMPLE.</h2>
    </header>

    <main>
        <div id='map'></div>

        <section id='overview'>
            <h3 id='overview-title'>Your trip to {{ city }}</h3>
            <p>from {{ date_from }} to {{ date_to }}</p>
        </section>

        <section id='accomodation'>
            <h4 id='accomodation-title'>路 Accomodation 路</h4>
            <div id='accomodation-details'>
                <!--content generated by result-c.js-->
            </div>
        </section>

        <section id='plan'>
            <h4 id='plan-title'>路 Travel Plan by Day 路</h4>
            <div id='plan-details'>
                <!--step 1, result-b.js: gather alllllll the data from google places api-->
                <!--step 3, result-c.js: generate contents-->
            </div>

            <div id='plan-scroll'>
                <!--for now don't actually implement the scrolling; -->
                <!--just display the whole long list - will change this later possibly using react-->
                <p id='loading-text'>
                    Making the plan for you...
                </p>
            </div>
        </section>

        <form action='/account/sign_up/' method='post'>
            {% csrf_token %}
            {{ form3.all_data }}
            <input id='prompt' class='btn btn-success' type='submit' value='Register/sign up to save and edit your itinerary'>
        </form>
    </main>

    <footer>
        <p>This is a footer<br/>uwu</p>
    </footer>
</body>